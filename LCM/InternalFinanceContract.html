[/* Title: Blank Reportview */]
<Link rel='stylesheet' href="[LL_REPTAG_LIBPATH /]bootstrap.css">
<Link rel='stylesheet' href="[LL_REPTAG_LIBPATH /]selectize.bootstrap3.min.css">
<link rel="stylesheet" href="[LL_REPTAG_LIBPATH /]datejs/the-datepicker.css">
<script src="[LL_REPTAG_LIBPATH /]datejs/the-datepicker.js"></script>
<script src="[LL_REPTAG_LIBPATH /]jquery.min.js"></script>
<script src="[LL_REPTAG_LIBPATH /]selectize.min.js"></script>
<script src="http://[LL_REPTAG_URLDOMAIN /]/img/webreports/library/bundle.min.js"></script>
<style>





.binf-widgets .custLoader{
	[LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
		margin-right: 45%;
	[LL_WEBREPORT_ELSE /]
		margin-left: 50%;
	[LL_WEBREPORT_ENDIF /]
    margin-left: 50%;
    margin-top: 20%;
    position: absolute;
    border: 12px solid #dbf1fe;
    border-left: 12px solid #0072aa;
    transform: translateZ(0);
    -webkit-animation: load8 1s infinite linear;
    animation: load8 1s infinite linear;
    width: 67px;
    height: 67px;
    z-index: 11111;
}


div.inner-border, div.custLoader {
    border-radius: 100%;
}   
.binf-widgets .close-icon:after {
   content: "ⓧ";
}
.binf-widgets .select-wrapper {
margin: auto;
max-width: 600px;
width: calc(100% - 40px);
}
.binf-widgets .select-pure__select {
align-items: center;
border-radius: 4px;
border: 1px solid rgba(0, 0, 0, 0.15);
box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
box-sizing: border-box;
cursor: pointer;
display: flex;
font-size: 12px;
font-weight: 500;
justify-content: left;
min-height: 54px;
padding: 5px 10px;
position: relative;
transition: 0.2s;
width: 100%;
}
.binf-widgets select{
    height: calc(1.90rem );
    font-size: 12px;"
}
.binf-widgets input{
    height: calc(1.90rem );
    font-size: 12px;"
}
    
.binf-widgets .select-pure__options {
border-radius: 4px;
border: 1px solid rgba(0, 0, 0, 0.15);
box-shadow: 0 2px 4px rgba(0, 0, 0, 0.04);
box-sizing: border-box;
color: #363b3e;
display: none;
left: 0;
max-height: 221px;
overflow-y: scroll;
position: absolute;
top: 50px;
width: 100%;
z-index: 5;
}
.binf-widgets .select-pure__select--opened .select-pure__options {
display: block;
}
.binf-widgets .select-pure__option {
background: #fff;
border-bottom: 1px solid #e4e4e4;
box-sizing: border-box;
height: auto;
padding: 10px;
}
.binf-widgets .select-pure__option--disabled {
color: #e4e4e4;
}
.binf-widgets .select-pure__option--selected {
color: #e4e4e4;
cursor: initial;
pointer-events: none;
}
.binf-widgets .select-pure__option--hidden {
display: none;
}
.binf-widgets .select-pure__selected-label {
align-items: 'center';
background: #2c5e7d;
border-radius: 4px;
color: #fff;
cursor: initial;
display: inline-flex;
justify-content: 'center';
margin: 5px 10px 5px 0;
padding: 3px 7px;
}
.binf-widgets .select-pure__selected-label:last-of-type {
margin-right: 0;
}
.binf-widgets .select-pure__selected-label i {
cursor: pointer;
display: inline-block;
margin-left: 7px;
}
.binf-widgets  .select-pure__selected-label img {
cursor: pointer;
display: inline-block;
height: 18px;
margin-left: 7px;
width: 14px;
}
.binf-widgets  .select-pure__selected-label i:hover {
color: #e4e4e4;
}
.binf-widgets .select-pure__autocomplete {
background: #f9f9f8;
border-bottom: 1px solid #e4e4e4;
border-left: none;
border-right: none;
border-top: none;
box-sizing: border-box;
font-size: 12px;
outline: none;
padding: 10px;
width: 100%;
}
.binf-widgets .select-pure__placeholder--hidden {
display: none;
}
.binf-widgets .select-pure__placeholder:befor{
content:"hhhh";
} 

.binf-widgets .custBtn {
bottom: 4px;
right: 23px;
border-radius: 16px;
height: 32px;
line-height: 12px;
padding: 0 24px;
color: #fff;
min-width: 80px;
border: 0;
}
[LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
    .binf-widgets label{
    padding-top: 10px;
    float: right;
    }
[LL_WEBREPORT_ELSE /]
    .binf-widgets label{
    padding-top: 10px;
    float: left;
    }
[LL_WEBREPORT_ENDIF /] 

.binf-widgets .buttonDiv{
bottom: 0;
position: sticky;
width: 100%;
border-top: 1px solid #a59f9f;
float:right;
}
.binf-widgets input {
height: calc(1.90rem );
font-size: 12px;
}
[/*]
.binf-widgets select {
height: calc(1.90rem );
font-size: 12px;
}
*/]
.binf-widgets textarea {
height: calc(1.92rem );
width: 100%;
font-size: 12px;
}
.binf-widgets #inputerror {
color: red;
}     
.binf-widgets #result {
position: relative;
width: 100%;
cursor: pointer;
overflow-y: auto;
max-height: 400px;
box-sizing: border-box;
z-index: 1001;
}
[//]
body {font-family: Arial;}
/* Style the tab */
.tab {
overflow: hidden;
border: 1px solid #ccc;
background-color: #f1f1f1;
}
/* Style the buttons inside the tab */
[LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
    .tab button {
    background-color: inherit;
    float: right;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 14px 16px;
    transition: 0.3s;
    font-size: 17px;
    }
[LL_WEBREPORT_ELSE /]
    .tab button {
    background-color: inherit;
    float: left;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 14px 16px;
    transition: 0.3s;
    font-size: 17px;
    }
[LL_WEBREPORT_ENDIF /] 

/* Change background color of buttons on hover */
.tab button:hover {
background-color: #ddd;
}
/* Create an active/current tablink class */
.tab button.active {
background-color: #ccc;
}
/* Style the tab content */
.tabcontent {
display: none;
padding: 6px 12px;
border: 1px solid #ccc;
border-top: none;
}
/* Style the close button */
.topright {
float: right;
cursor: pointer;
font-size: 28px;
}
.topright:hover {color: red;}
.binf-widgets .center {
margin: auto;
width: 60%;
border: 3px solid #73AD21;
padding: 10px;
}

.binf-widgets .center {
margin: auto;
width: 60%;
border: 3px solid #73AD21;
padding: 10px;
}
.showErrorField{
box-shadow: 0 0 4px 1px #f91615;
}

.switch {
  position: relative;
  display: inline-block;
  width: 45px;
  height: 25px;
  float: right;
  margin-top: -3px;
  margin-left: 10px;
}

.switch input { 
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  -webkit-transition: .4s;
  transition: .4s;
}

.slider:before {
  position: absolute;
  content: "";
  height: 21px;
  width: 21px;
  left: 4px;
  bottom: 2px;
  background-color: white;
  -webkit-transition: .4s;
  transition: .4s;
}

input:checked + .slider {
  background-color: #3975a2;
}



input:checked + .slider:before {
  -webkit-transform: translateX(18px);
  -ms-transform: translateX(18px);
  transform: translateX(18px);
}

/* Rounded sliders */
.slider.round {
  border-radius: 34px;
}

.slider.round:before {
  border-radius: 50%;
}

.has-options.items.not-full.selectize-input {
    border: 1px solid #ced4da;
}

.selectize-input.items.not-full{
    border: solid 0.5px #ced4da;
}

.selectize-input.items.has-options.full.has-items{
    display: flex;
    align-items: center;

}
#select-state-selectized{
    left:14px !important;
}

input#select-state-selectized {
    position: initial !important;
}

input#select-state-finance-agreement-selectized {
    position: initial !important;
}



</style>
[LL_WEBREPORT_STARTROW /]
[LL_WEBREPORT_ENDROW /]

<div class="tile-content csui-normal-scrolling csui-no-scroll-x" style="height: 100%; margin-top: 0px; background-color:#0a163c;position:absolute;">
    <div class="p-4 rounded bg-white js-active" style="margin-left: 1%;margin-right: 1%; margin-top: 1%; margin-bottom:20px;">

<div class="tab">
   <button class="tablinks" onclick="openCase(event, 'Case')" id="defaultOpen">
         [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
         اضافة عقد
        [LL_WEBREPORT_ELSE /]
           Add Contract
        [LL_WEBREPORT_ENDIF /]       
   </button>
</div>

<div id="Case" class="tabcontent" style="display:block;height: 100%;">

   <div class="container-fluid" style="position: relative;top: 5%;width: 100%;height: 84%;">
      <form NAME="myFormContract" action="javascript:void(0)()" style="height: 100%;">
         <!-- <div class="p-4 rounded bg-white js-active container"> -->
         <div style="margin: 14px;">
         
        <div id="financeContractAgreementForm" class="row" style="height: 100%;">

            <div class="col-sm-3 col-lg-3 col-md-3 col-xs-3">
                <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
   
                    <label class="binf-control-label alpaca-control-label" style="font-size: small;margin-top:10px;">
                    [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
                    اضافة عقد موثق
                  [LL_WEBREPORT_ELSE /]
                  Add Documented Contract
                  [LL_WEBREPORT_ENDIF /] 
                    </label>
                    
                <label class="switch" style="margin-top:15px;margin-left:10px;">
                    
                    <input id="AddDocumentedContract" type="checkbox" checked>
                    <span class="slider round"></span>
                </label>
   
            </div>
        </div>


        <div class="col-sm-3 col-lg-3 col-md-3 col-xs-3">
            <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">

                <label class="binf-control-label alpaca-control-label" style="font-size: small;margin-top:10px;">
                [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
                اضافة عقد داخلي
              [LL_WEBREPORT_ELSE /]
              Add Internal Contract
              [LL_WEBREPORT_ENDIF /] 
                </label>
                
            <label class="switch" style="margin-top:15px;margin-left:10px;">
                
                <input id="AddInternalContract" type="checkbox" >
                <span class="slider round"></span>
            </label>

        </div>
    </div>

    <div class="col-sm-6 col-lg-6 col-md-6 col-xs-6">
        <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
</div>
</div>

    <div class="col-sm-6 col-lg-6 col-md-6 col-xs-6">
        <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">

            <label class="binf-control-label alpaca-control-label" style="font-size:small">
                [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
            ملف العميل
            [LL_WEBREPORT_ELSE /]
            Customer File
            [LL_WEBREPORT_ENDIF /]                                  
             </label>
<select id="select-state">
    <option value="" placeholder="">Select</option>
    
    </select>

    </div>
</div>


<div class="col-sm-6 col-lg-6 col-md-6 col-xs-6">
    <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">

        <label class="binf-control-label alpaca-control-label" style="font-size:small">
            [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
            التمويل
        [LL_WEBREPORT_ELSE /]
        Finance Agreement
        [LL_WEBREPORT_ENDIF /]                                  
         </label>
<select id="select-state-finance-agreement">
<option value="" placeholder="">Select</option>

</select>

</div>
</div>


<div class="col-sm-6 col-lg-6 col-md-6 col-xs-6">
    <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
       <label class="binf-control-label alpaca-control-label" style="font-size:small">
          [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
           نوع العقد
          [LL_WEBREPORT_ELSE /]
            Type of Contract
          [LL_WEBREPORT_ENDIF /]                      
       </label>
       <select class="valueEditable  form-control"  id="TypeOfContract" required>
          <option value=''>select Contract Type</option>
          <option value='اساسي'>اساسي</option>
          <option value='تعديل'>تعديل</option>
       </select>
    </div>
   </div>


    <div class="col-sm-6 col-lg-6 col-md-6 col-xs-6" style="display: none;" id="originalContractNumber">
        <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
            
            <label class="binf-control-label alpaca-control-label" style="font-size:small">
                [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
                رقم العقد الأساسي
        [LL_WEBREPORT_ELSE /]
        Original Contract Number
        [LL_WEBREPORT_ENDIF /]                                  
    </label>
        <select id="select-state-internal-doc-contracts">
            <option value="" placeholder="">Select</option>
            
        </select>
        
    </div>
</div>

    <div id="documentedContractForm" class="row" style="height: 100%;">

        
            <div class="col-sm-6 col-lg-6 col-md-6 col-xs-6">
                <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
                   <label class="binf-control-label alpaca-control-label" style="font-size:small">
                      [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
                      رقم العقد الموثق
                      [LL_WEBREPORT_ELSE /]
                      Documented Contract Number
                      [LL_WEBREPORT_ENDIF /]                                  
                   </label>
                   <input type="text" class="valueEditable  form-control"  placeholder="Documented Contract Number" id="DocumentedContractNumber" />
                </div>
             </div>


             <div class="col-sm-6 col-lg-6 col-md-6 col-xs-6">
                <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
                 <label class="binf-control-label alpaca-control-label" style="font-size:small">
                    [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
                    تاريخ العقد الموثق
                    [LL_WEBREPORT_ELSE /]
                    Documented Contract Date
                    [LL_WEBREPORT_ENDIF /]                         
                </label>
                 <input type="date" class="valueEditable  form-control" placeholder="Documented Contract Date" id="DocumentedContractDate" />
                 <script>
                    if ( document.getElementById('DocumentedContractDate').type != "date" ){
                        const input = document.getElementById('DocumentedContractDate');
                        const datepicker = new TheDatepicker.Datepicker(input);
                        var today = new Date();
                        var dd = today.getDate();
                        var mm = today.getMonth()+1; 
                        var yyyy = today.getFullYear();
                        if(dd<10) 
                        {
                            dd='0'+dd;
                        } 
                    
                        if(mm<10) 
                        {
                           mm='0'+mm;
                        } 
                        today = mm+'/'+dd+'/'+yyyy;
                        datepicker.options.setInputFormat(today);
                        datepicker.render();
                    }
                 </script>
              </div>
           </div>



          

           
           

           


           <div id="addSetContract" class="row" style="width: 100%;">
            
            
            <div class="col-sm-4 col-lg-4 col-md-4 col-xs-4">
            <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
             <label class="binf-control-label alpaca-control-label" style="font-size:small">
                [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
                تاريخ قيد رهن المحل التجاري
                [LL_WEBREPORT_ELSE /]
                Mortgage Registration Date
                [LL_WEBREPORT_ENDIF /]                         
            </label>
             <input type="date" class="valueEditable  form-control" placeholder="Mortgage Registration Date" id="MortgageRegistrationDate1" />
             <script>
                if ( document.getElementById('MortgageRegistrationDate1').type != "date" ){
                    const input = document.getElementById('MortgageRegistrationDate1');
                    const datepicker = new TheDatepicker.Datepicker(input);
                    var today = new Date();
                    var dd = today.getDate();
                    var mm = today.getMonth()+1; 
                    var yyyy = today.getFullYear();
                    if(dd<10) 
                    {
                        dd='0'+dd;
                    } 
                
                    if(mm<10) 
                    {
                       mm='0'+mm;
                    } 
                    today = mm+'/'+dd+'/'+yyyy;
                    datepicker.options.setInputFormat(today);
                    datepicker.render();
                }
             </script>
          </div>
       </div>


       
       
       <div class="col-sm-4 col-lg-4 col-md-4 col-xs-4">
        <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
         <label class="binf-control-label alpaca-control-label" style="font-size:small">
            [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
            تاريخ قائمة قيد الرهن
            [LL_WEBREPORT_ELSE /]
            Foreclosure List Date
            [LL_WEBREPORT_ENDIF /]                         
        </label>
         <input type="date" class="valueEditable  form-control" placeholder="Foreclosure List Date" id="ForeclosureListDate1" />
         <script>
            if ( document.getElementById('ForeclosureListDate1').type != "date" ){
                const input = document.getElementById('ForeclosureListDate1');
                const datepicker = new TheDatepicker.Datepicker(input);
                var today = new Date();
                var dd = today.getDate();
                var mm = today.getMonth()+1; 
                var yyyy = today.getFullYear();
                if(dd<10) 
                {
                    dd='0'+dd;
                } 
            
                if(mm<10) 
                {
                   mm='0'+mm;
                } 
                today = mm+'/'+dd+'/'+yyyy;
                datepicker.options.setInputFormat(today);
                datepicker.render();
            }
         </script>
      </div>
   </div>

   

   <div class="col-sm-4 col-lg-4 col-md-4 col-xs-4">
    <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
        <label class="binf-control-label alpaca-control-label" style="font-size:small">
            [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
            رقم قائمة قيد الرهن
            [LL_WEBREPORT_ELSE /]
            Foreclosure List Number
            [LL_WEBREPORT_ENDIF /]                                  
        </label>
        <input type="text" class="valueEditable  form-control"  placeholder="Foreclosure List Number" id="ForeclosureListNumber1" />
    </div>
</div>

<div class="col-sm-3 col-lg-3 col-md-3 col-xs-3">
 <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
    <label class="binf-control-label alpaca-control-label" style="font-size:small">
       [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
    منطقة
       [LL_WEBREPORT_ELSE /]
   Area
       [LL_WEBREPORT_ENDIF /]                                  
    </label>
    <input type="text" class="valueEditable  form-control"  placeholder="Area" id="Area1" />
 </div>
</div>

<div class="col-sm-3 col-lg-3 col-md-3 col-xs-3">
  <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
     <label class="binf-control-label alpaca-control-label" style="font-size:small">
        [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
  القطعة
        [LL_WEBREPORT_ELSE /]
     Plot
        [LL_WEBREPORT_ENDIF /]                                  
     </label>
     <input type="text" class="valueEditable  form-control"  placeholder="Plot" id="Plot1" />
  </div>
</div>

<div class="col-sm-3 col-lg-3 col-md-3 col-xs-3">
  <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
     <label class="binf-control-label alpaca-control-label" style="font-size:small">
        [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
        القسيمة
        [LL_WEBREPORT_ELSE /]
        Division
        [LL_WEBREPORT_ENDIF /]                                  
     </label>
     <input type="text" class="valueEditable  form-control"  placeholder="Division" id="Division1" />
  </div>
</div>





<div class="col-sm-3 col-lg-3 col-md-3 col-xs-3">
  <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
     <label class="binf-control-label alpaca-control-label" style="font-size:small">
        [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
        مساحة القسيمة
        [LL_WEBREPORT_ELSE /]
        Division Area
        [LL_WEBREPORT_ENDIF /]                                  
     </label>
     <input type="text" class="valueEditable  form-control"  placeholder="Division Area" id="DivisionArea1" />
  </div>
</div>



 <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
    <div class="col-sm col-lg col-md col-xs">
       <label class="binf-control-label alpaca-control-label">
          [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
          ضمانات
          [LL_WEBREPORT_ELSE /]
          Guarantees
          [LL_WEBREPORT_ENDIF /]                                  
       </label>
       <textarea class="form-control" id="Guarantees1" style="height: 100px"></textarea>
    </div>
 </div>

    <br >
</div>
<div class="col-sm-12 col-lg-12 col-md-12 col-xs-12">
    <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
            
            <input type="Submit" value="Add Row" class="binf-btn binf-btn-primary" id="addRowButtonContractAgreementForm"/>
        </div>
    
    </div>

 </div>

<br >


 

        <div id="internalContractForm" class="row" style="height: 100%;display: none;">
            
            <div class="col-sm-6 col-lg-6 col-md-6 col-xs-6">
                <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
                 <label class="binf-control-label alpaca-control-label" style="font-size:small">
                    [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
                      التاريخ
                      [LL_WEBREPORT_ELSE /]
                      Date
                      [LL_WEBREPORT_ENDIF /]                         
                </label>
                 <input type="date" class="valueEditable  form-control" placeholder="Date" id="InternalContractDate" />
                 <script>
                    if ( document.getElementById('InternalContractDate').type != "date" ){
                        const input = document.getElementById('InternalContractDate');
                        const datepicker = new TheDatepicker.Datepicker(input);
                        var today = new Date();
                        var dd = today.getDate();
                        var mm = today.getMonth()+1; 
                        var yyyy = today.getFullYear();
                        if(dd<10) 
                        {
                            dd='0'+dd;
                        } 
                    
                        if(mm<10) 
                        {
                           mm='0'+mm;
                        } 
                        today = mm+'/'+dd+'/'+yyyy;
                        datepicker.options.setInputFormat(today);
                        datepicker.render();
                    }
                 </script>
              </div>
           </div>
            
            
            <div class="col-sm-6 col-lg-6 col-md-6 col-xs-6">
                <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
                   <label class="binf-control-label alpaca-control-label" style="font-size:small">
                      [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
                      المبلغ
                      [LL_WEBREPORT_ELSE /]
                      Amount
                      [LL_WEBREPORT_ENDIF /]                                  
                   </label>
                   <input type="text" class="valueEditable  form-control"  placeholder="Amount" id="InternalContractAmount" />
                </div>
             </div>


             





        </div>


        </div>
        


        </div>
		 
        
		 
		   
				
				
	

		 <br >
         <br >
         <br>
		 
        <div style="position: relative;">
           
			
        [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
        <input type="Submit" class="binf-btn binf-btn-primary csui-custom-search-form-submit custBtn" value="Create" id="CreateCustomerFile" style="right:auto" />
        [LL_WEBREPORT_ELSE /]
                <input type="Submit" class="binf-btn binf-btn-primary csui-custom-search-form-submit custBtn" value="Create" id="CreateCustomerFile" /> 
        [LL_WEBREPORT_ENDIF /] 
        
        </div>
        

		   
      </form>
   </div>
</div>


</div>
</div>
<div id="LoadingImagePO" class="custLoader" style="display: none;"></div>



<script>

						
	csui.require(['csui/lib/jquery'], function ($) {
        
	$("#addRowButtonCustomerFile").on("click", function(event) {					
	event.preventDefault();
	setCounterCustomerFile += 1;
		
    var stringTempToAppend = `
        <div class="col-sm-6 col-lg-6 col-md-6 col-xs-6">
            <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
               <label class="binf-control-label alpaca-control-label" style="font-size:small">
                  [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
                  رقم الترخيص الصناعي
                  [LL_WEBREPORT_ELSE /]
                  Industrial License Number
                  [LL_WEBREPORT_ENDIF /]                                  
               </label>
               <input type="text" class="valueEditable  form-control"  placeholder="Industrial License Number" id="IndustrialLicenseNumber${setCounterCustomerFile}" />
            </div>
         </div>
		 
		 
		  <div class="col-sm-6 col-lg-6 col-md-6 col-xs-6">
                    <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
                     <label class="binf-control-label alpaca-control-label" style="font-size:small">
                        [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
                        تاريخ الترخيص الصناعي
                        [LL_WEBREPORT_ELSE /]
                        Industrial License Date
                        [LL_WEBREPORT_ENDIF /]                         
                    </label>
                     <input type="date" class="valueEditable  form-control" placeholder="Industrial License Date" id="IndustrialLicenseDate${setCounterCustomerFile}" />

                    </div>
                </div>`;


		$("#mainFormWithSetCustomerFile").append(stringTempToAppend); 
						
		console.log(setCounterCustomerFile);
		if(setCounterCustomerFile >= 4){
			document.getElementById("addRowButtonCustomerFile").style.display = 'none'; 
		}
	
	});
	

    $("#addRowButtonContractAgreementForm").on("click", function(event) {					
	event.preventDefault();
	setCounterContractAgreementForm += 1;
		
    var stringTempToAppend = `
    <div class="col-sm-4 col-lg-4 col-md-4 col-xs-4">
            <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
             <label class="binf-control-label alpaca-control-label" style="font-size:small">
                [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
                تاريخ قيد رهن المحل التجاري
                [LL_WEBREPORT_ELSE /]
                Mortgage Registration Date
                [LL_WEBREPORT_ENDIF /]                         
            </label>
             <input type="date" class="valueEditable  form-control" placeholder="Mortgage Registration Date" id="MortgageRegistrationDate${setCounterContractAgreementForm}" />
            
          </div>
       </div>


       
       
       <div class="col-sm-4 col-lg-4 col-md-4 col-xs-4">
        <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
         <label class="binf-control-label alpaca-control-label" style="font-size:small">
            [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
            تاريخ قائمة قيد الرهن
            [LL_WEBREPORT_ELSE /]
            Foreclosure List Date
            [LL_WEBREPORT_ENDIF /]                         
        </label>
         <input type="date" class="valueEditable  form-control" placeholder="Foreclosure List Date" id="ForeclosureListDate${setCounterContractAgreementForm}" />
         
      </div>
   </div>

   

   <div class="col-sm-4 col-lg-4 col-md-4 col-xs-4">
    <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
        <label class="binf-control-label alpaca-control-label" style="font-size:small">
            [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
            رقم قائمة قيد الرهن
            [LL_WEBREPORT_ELSE /]
            Foreclosure List Number
            [LL_WEBREPORT_ENDIF /]                                  
        </label>
        <input type="text" class="valueEditable  form-control"  placeholder="Foreclosure List Number" id="ForeclosureListNumber${setCounterContractAgreementForm}" />
    </div>
</div>

<div class="col-sm-3 col-lg-3 col-md-3 col-xs-3">
 <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
    <label class="binf-control-label alpaca-control-label" style="font-size:small">
       [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
    منطقة
       [LL_WEBREPORT_ELSE /]
   Area
       [LL_WEBREPORT_ENDIF /]                                  
    </label>
    <input type="text" class="valueEditable  form-control"  placeholder="Area" id="Area${setCounterContractAgreementForm}" />
 </div>
</div>

<div class="col-sm-3 col-lg-3 col-md-3 col-xs-3">
  <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
     <label class="binf-control-label alpaca-control-label" style="font-size:small">
        [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
  القطعة
        [LL_WEBREPORT_ELSE /]
     Plot
        [LL_WEBREPORT_ENDIF /]                                  
     </label>
     <input type="text" class="valueEditable  form-control"  placeholder="Plot" id="Plot${setCounterContractAgreementForm}" />
  </div>
</div>

<div class="col-sm-3 col-lg-3 col-md-3 col-xs-3">
  <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
     <label class="binf-control-label alpaca-control-label" style="font-size:small">
        [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
        القسيمة
        [LL_WEBREPORT_ELSE /]
        Division
        [LL_WEBREPORT_ENDIF /]                                  
     </label>
     <input type="text" class="valueEditable  form-control"  placeholder="Division" id="Division${setCounterContractAgreementForm}" />
  </div>
</div>





<div class="col-sm-3 col-lg-3 col-md-3 col-xs-3">
  <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
     <label class="binf-control-label alpaca-control-label" style="font-size:small">
        [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
        مساحة القسيمة
        [LL_WEBREPORT_ELSE /]
        Division Area
        [LL_WEBREPORT_ENDIF /]                                  
     </label>
     <input type="text" class="valueEditable  form-control"  placeholder="Division Area" id="DivisionArea${setCounterContractAgreementForm}" />
  </div>
</div>



 <div class="col-sm-11 col-lg-11 col-md-11 col-xs-11">
    <div class="col-sm col-lg col-md col-xs">
       <label class="binf-control-label alpaca-control-label">
          [LL_WEBREPORT_IF "[LL_REPTAG_USERID USERPREF:GENERAL:LANGUAGE:CODE /]" == "_ar" /]
          ضمانات
          [LL_WEBREPORT_ELSE /]
          Guarantees
          [LL_WEBREPORT_ENDIF /]                                  
       </label>
       <textarea class="form-control" id="Guarantees${setCounterContractAgreementForm}" style="height: 100px"></textarea>
    </div>
 </div>

        `;


		$("#addSetContract").append(stringTempToAppend); 
						
		console.log(setCounterContractAgreementForm);
		if(setCounterContractAgreementForm >= 4){
			document.getElementById("addRowButtonContractAgreementForm").style.display = 'none'; 
		}
	
	});
	


    $("#AddFinance").change(function() {
        if(this.checked) {
            $('#financeAgreementForm').show();
        } else {
            $('#financeAgreementForm').hide();
            $('#financeContractAgreementForm').hide();
            $('#AddContract').prop('checked', false);
        }
	
    });

    $("#AddContract").change(function() {
        if(this.checked) {
            $('#financeContractAgreementForm').show();
        } else {
            $('#financeContractAgreementForm').hide();
        }
	
    });

    $("#AddDocumentedContract").change(function() {
        if(this.checked) {
            $("#AddInternalContract").prop('checked', false);
            $('#documentedContractForm').show();
            $('#internalContractForm').hide();
        } else {
            $('#documentedContractForm').hide();
        }
	
    });

    $("#AddInternalContract").change(function() {
        if(this.checked) {
            $("#AddDocumentedContract").prop('checked', false);
            $("#internalContractForm").css("display", "contents");
            $('#documentedContractForm').hide();
        } else {
            $('#internalContractForm').hide();
        }
	
    });

    $('#TypeOfContract').on('change', function() {
        if(this.value == "تعديل"){
            $('#originalContractNumber').show();
        } else {
            $('#originalContractNumber').hide();
        }
    });


    


});

</script>








<script>
  //Initial Load
   var userList=[];   
   var setCounterCustomerFile = 1;
   var setCounterContractAgreementForm=1;

   
   var $select = $('#select-state').selectize({});
   var $selectFinance = $('#select-state-finance-agreement').selectize({});
   var $selectInternalDocContract = $('#select-state-internal-doc-contracts').selectize({});
   

   var selectize = $select[0].selectize;
   var selectizeFinance = $selectFinance[0].selectize;
   var selectizeInternalDocContract = $selectInternalDocContract[0].selectize;
   
   csui.require(['csui/lib/jquery'], function ($) {    
       var TileReportConfig = {};
       TileReportConfig.urlPrefix =  '[LL_REPTAG_URLPREFIX /]';
       TileReportConfig.otcsTicket = '[LL_REPTAG_OTCSTICKET /]';
       
       
    });
    
    
    $(document).ready(function(){

         $.ajax({
            url:"[LL_REPTAG_URLPREFIXFULL /]/api/v2/businessworkspaces?where_workspace_type_id=7&limit=40&page=1",
            type: "GET",
            beforeSend: function(xhr){
                xhr.setRequestHeader('OTCSTicket', '[LL_REPTAG_OTCSTICKET /]');
            },
            success:function(data){
                for(const item of data.results){
                    if(item.data.properties.name == "Customer File Document Template" || item.data.properties.name == "ملف العميل"){
                        continue;
                    }

                    console.log(item.data.properties.name);
                    console.log(item.data.properties.id);

                    selectize.addOption({value: item.data.properties.id, text: item.data.properties.name});
                }
            },
            error: function(xhr, status, error) {
                var err = JSON.parse(xhr.responseText);
                csui.require(['csui/dialogs/modal.alert/modal.alert'], function (ModalAlert) {
                    ModalAlert.showError("Retrieving Customer Files records Error. "+err.error).always(function () { 
                    });

                });                      
            }
        });


        $.ajax({
            url:"[LL_REPTAG_URLPREFIXFULL /]/api/v2/businessworkspaces?where_workspace_type_id=8&limit=40&page=1",
            type: "GET",
            beforeSend: function(xhr){
                xhr.setRequestHeader('OTCSTicket', '[LL_REPTAG_OTCSTICKET /]');
            },
            success:function(data){
                for(const item of data.results){
                    if(item.data.properties.name == "Finance Agreement Document Template" || item.data.properties.name == "التمويل"){
                        continue;
                    }

                    console.log(item.data.properties.name);
                    console.log(item.data.properties.id);

                    selectizeFinance.addOption({value: item.data.properties.id, text: item.data.properties.name});
                }
            },
            error: function(xhr, status, error) {
                var err = JSON.parse(xhr.responseText);
                csui.require(['csui/dialogs/modal.alert/modal.alert'], function (ModalAlert) {
                    ModalAlert.showError("Retrieving Finance Agreement records Error. "+err.error).always(function () { 
                    });

                });                      
            }
        });



        $.ajax({
            url:"[LL_REPTAG_URLPREFIXFULL /]/api/v2/businessworkspaces?where_workspace_type_id=9&limit=40&page=1",
            type: "GET",
            beforeSend: function(xhr){
                xhr.setRequestHeader('OTCSTicket', '[LL_REPTAG_OTCSTICKET /]');
            },
            success:function(data){
                for(const item of data.results){
                    if(item.data.properties.name == "Internal Finance Contract Document Template" || item.data.properties.name == "عقد التمويل الداخلي"){
                        continue;
                    }

                    console.log(item.data.properties.name);
                    console.log(item.data.properties.id);

                    selectizeInternalDocContract.addOption({value: item.data.properties.id, text: item.data.properties.name});
                }
            },
            error: function(xhr, status, error) {
                var err = JSON.parse(xhr.responseText);
                csui.require(['csui/dialogs/modal.alert/modal.alert'], function (ModalAlert) {
                    ModalAlert.showError("Retrieving Internal Finance Contracts records Error. "+err.error).always(function () { 
                    });

                });                      
            }
        });





        $('#select-state-selectized').on('input',()=>{
            let value = $('#select-state-selectized').val();
            let condition = "";
            if(value.length > 0){
                condition = `&where_name=contains_${value}`;
            }
            $.ajax({
                url:`[LL_REPTAG_URLPREFIXFULL /]/api/v2/businessworkspaces?where_workspace_type_id=7&limit=40&page=1${condition}`,
                type: "GET",
                beforeSend: function(xhr){
                    xhr.setRequestHeader('OTCSTicket', '[LL_REPTAG_OTCSTICKET /]');
                },
                success:function(data){
                    selectize.clearOptions(); 
                    if(data.results.length > 0){
                        for(const item of data.results){
                            if(item.data.properties.name == "Customer File Document Template" || item.data.properties.name == "ملف العميل"){
                                continue;
                            }
    
                            selectize.addOption({value: item.data.properties.id, text: item.data.properties.name});
                        }
                    }
                },
                error: function(xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    csui.require(['csui/dialogs/modal.alert/modal.alert'], function (ModalAlert) {
                        ModalAlert.showError("Retrieving Customer Files records Error. "+err.error).always(function () { 
                        });

                    });                      
                }
            
             });
        })

        
        $('#select-state-finance-agreement-selectized').on('input',()=>{
            let value = $('#select-state-finance-agreement-selectized').val();
            let condition = "";
            if(value.length > 0){
                condition = `&where_name=contains_${value}`;
            }
            $.ajax({
                url:`[LL_REPTAG_URLPREFIXFULL /]/api/v2/businessworkspaces?where_workspace_type_id=8&limit=40&page=1${condition}`,
                type: "GET",
                beforeSend: function(xhr){
                    xhr.setRequestHeader('OTCSTicket', '[LL_REPTAG_OTCSTICKET /]');
                },
                success:function(data){
                    selectizeFinance.clearOptions(); 
                    if(data.results.length > 0){
                        for(const item of data.results){
                            if(item.data.properties.name == "Finance Agreement Document Template" || item.data.properties.name == "التمويل"){
                                continue;
                            }
    
                            selectizeFinance.addOption({value: item.data.properties.id, text: item.data.properties.name});
                        }
                    }
                },
                error: function(xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    csui.require(['csui/dialogs/modal.alert/modal.alert'], function (ModalAlert) {
                        ModalAlert.showError("Retrieving Finance Agreement records Error. "+err.error).always(function () { 
                        });

                    });                      
                }
            
             });
        })



        $('#select-state-internal-doc-contracts-selectized').on('input',()=>{
            let value = $('#select-state-internal-doc-contracts-selectized').val();
            let condition = "";
            if(value.length > 0){
                condition = `&where_name=contains_${value}`;
            }
            $.ajax({
                url:`[LL_REPTAG_URLPREFIXFULL /]/api/v2/businessworkspaces?where_workspace_type_id=9&limit=40&page=1${condition}`,
                type: "GET",
                beforeSend: function(xhr){
                    xhr.setRequestHeader('OTCSTicket', '[LL_REPTAG_OTCSTICKET /]');
                },
                success:function(data){
                    selectizeInternalDocContract.clearOptions(); 
                    if(data.results.length > 0){
                        for(const item of data.results){
                            if(item.data.properties.name == "Internal Finance Contract Document Template" || item.data.properties.name == "عقد التمويل الداخلي"){
                                continue;
                            }
    
                            selectizeInternalDocContract.addOption({value: item.data.properties.id, text: item.data.properties.name});
                        }
                    }
                },
                error: function(xhr, status, error) {
                    var err = JSON.parse(xhr.responseText);
                    csui.require(['csui/dialogs/modal.alert/modal.alert'], function (ModalAlert) {
                        ModalAlert.showError("Retrieving Finance Agreement records Error. "+err.error).always(function () { 
                        });

                    });                      
                }
            
             });
        })

       
       
 
     });


</script>
<script>
   function openCase(evt, caseName) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(caseName).style.display = "block";
        evt.currentTarget.className += " active";
    }

    csui.require(['csui/lib/jquery'], function ($) {
        
		
		
		$("#CreateCustomerFile").on("click", function(event) {
	        event.preventDefault();
			let valCustomerFile = selectize.getValue();
            let valFinanceAgreement = selectizeFinance.getValue();
            if(valCustomerFile.length == 0 || valFinanceAgreement.length == 0){
                csui.require(['csui/dialogs/modal.alert/modal.alert'], function (ModalAlert) {
                        ModalAlert.showError("Customer File or Finance Agreement Not Chosen.").always(function () { 
                    });

                });    
                return;  
            }

            if($("#AddDocumentedContract").is(":checked")){
                createInternalFinanceContract(valCustomerFile,valFinanceAgreement);
            }


            if($("#AddInternalContract").is(":checked")){
                createInternalContract(valCustomerFile,valFinanceAgreement);
            }
	        
	    });
		
		

   
    function createInternalFinanceContract(CustomerFileID,FinanceAgreementID){
    var DocumentedContractNumber = $('#DocumentedContractNumber').val();
    var DocumentedContractDate = $('#DocumentedContractDate').val();
    var typeOfContract1 = $('#TypeOfContract').val();

    let valDocumentedContract;
    if(typeOfContract1 == "تعديل"){
        valDocumentedContract = selectizeInternalDocContract.getValue();
    } else {
        valDocumentedContract = "";
    }

    if(DocumentedContractNumber!='' & DocumentedContractDate!='' & typeOfContract1!=''){
                        

        var form = new FormData();
        
        var data = {
            "template_id":[LL_REPTAG_$InternalFinanceContract_DocTemp /] ,
            "parent_id": [LL_REPTAG_$InternalFinanceContract_ParentID /], // folder where the cws will be created
            "roles": { 
                "categories": {
                    "[LL_REPTAG_$CatInternalFinanceContract /]": {
                        "[LL_REPTAG_$CatInternalFinanceContract /]_3":DocumentedContractNumber,
                        "[LL_REPTAG_$CatInternalFinanceContract /]_2":DocumentedContractDate,
                        "[LL_REPTAG_$CatInternalFinanceContract /]_19":typeOfContract1,
                    }
                }
            }
        };	
        
        var setFieldsWithUpdate = {};
            
        for(var i=1;i<=setCounterContractAgreementForm;i++){
            setFieldsWithUpdate[`[LL_REPTAG_$CatInternalFinanceContract /]_5_${i}_6`] = $('#ForeclosureListDate'+i).val();
            setFieldsWithUpdate[`[LL_REPTAG_$CatInternalFinanceContract /]_5_${i}_7`] = $('#ForeclosureListNumber'+i).val();
            setFieldsWithUpdate[`[LL_REPTAG_$CatInternalFinanceContract /]_5_${i}_8`] = $('#Guarantees'+i).val();

            setFieldsWithUpdate[`[LL_REPTAG_$CatInternalFinanceContract /]_5_${i}_14`] = $('#MortgageRegistrationDate'+i).val();
            setFieldsWithUpdate[`[LL_REPTAG_$CatInternalFinanceContract /]_5_${i}_15`] = $('#Area'+i).val();
            setFieldsWithUpdate[`[LL_REPTAG_$CatInternalFinanceContract /]_5_${i}_16`] = $('#Plot'+i).val();
            setFieldsWithUpdate[`[LL_REPTAG_$CatInternalFinanceContract /]_5_${i}_17`] = $('#Division'+i).val();
            setFieldsWithUpdate[`[LL_REPTAG_$CatInternalFinanceContract /]_5_${i}_18`] = $('#DivisionArea'+i).val();
        }
        

        console.log(data);
        
        $('#LoadingImagePO').show();                
        form.append("body", JSON.stringify(data));
            $.ajax({
            url:"[LL_REPTAG_URLPREFIXFULL /]/api/v2/businessworkspaces",
            type: "POST",
            processData: false,
            mimeType: "multipart/form-data",
            contentType: false,
            data: form ,               
            beforeSend: function(xhr){
                xhr.setRequestHeader('OTCSTicket', '[LL_REPTAG_OTCSTICKET /]');
            },
            success:function(data){
                var res=JSON.parse(data);
                
                $('#LoadingImagePO').hide();
                data = setFieldsWithUpdate;
                    
                var settings = {
                    "url": "[LL_REPTAG_URLPREFIXFULL /]/api/v1/nodes/"+res.results.id+"/categories/[LL_REPTAG_$CatInternalFinanceContract /]/",
                    "method": "PUT",
                    "timeout": 0,
                    "headers": {
                    "OTCSTicket": "[LL_REPTAG_OTCSTICKET /]"
                    },
                    data
                };
                    
                    
                console.log(settings); 
                    
                $.ajax(settings).done(function (response) {
                    console.log(response);


                    var settingsAjax = {
                        "url": `[LL_REPTAG_URLPREFIXFULL /]/api/v2/businessworkspaces/${FinanceAgreementID}/relateditems`,
                        "method": "POST",
                        "timeout": 0,
                        "headers": {
                            "OTCSTicket": "[LL_REPTAG_OTCSTICKET /]",
                            "Content-Type": "application/x-www-form-urlencoded"
                        },
                        "data": {
                            "rel_bw_id": res.results.id,
                            "rel_type": "child"
                        }
                    };
    
                    $.ajax(settingsAjax).done(function (response) {

                        
                        if(valDocumentedContract != ""){
                                var settingsAjaxDocumented = {
                                    "url": `[LL_REPTAG_URLPREFIXFULL /]/api/v2/businessworkspaces/${valDocumentedContract}/relateditems`,
                                    "method": "POST",
                                    "timeout": 0,
                                    "headers": {
                                        "OTCSTicket": "[LL_REPTAG_OTCSTICKET /]",
                                        "Content-Type": "application/x-www-form-urlencoded"
                                    },
                                    "data": {
                                        "rel_bw_id": res.results.id,
                                        "rel_type": "child"
                                    }
                                };

                                $.ajax(settingsAjaxDocumented).done(function (response) {
                                    csui.require(['csui/dialogs/modal.alert/modal.alert'], function (ModalAlert) {
                                    ModalAlert.showSuccess("Documented Contract Created").always(function () { 
                                        $("form")[0].reset();
                                    window.location.replace("[LL_REPTAG_URLPREFIX /]/app/nodes/"+res.results.id);
                                    });
                                    }); 

                                });


                            } else {
                        
                        
                                csui.require(['csui/dialogs/modal.alert/modal.alert'], function (ModalAlert) {
                            ModalAlert.showSuccess("Documented Contract Created").always(function () { 
                                $("form")[0].reset();
                            window.location.replace("[LL_REPTAG_URLPREFIX /]/app/nodes/"+res.results.id);
                            });
                            });  
                             }
                        

                            
                        
                    });
                   
                    
                });



            },
            error: function(xhr, status, error) {
                $('#LoadingImagePO').hide();
                var err = JSON.parse(xhr.responseText);
                //alert(err.error);
                csui.require(['csui/dialogs/modal.alert/modal.alert'], function (ModalAlert) {
                    ModalAlert.showError("Documented Contract Creation Error. "+err.error).always(function () { 
                    });

                });                      
            }
        });                      
    }

    else{
        if(typeOfContract1==''){
            $('#TypeOfContract').css({'border-color':'red'});
        }
        else{
            $('#TypeOfContract').css({'border-color':'#ced4da'});
        }
        if(DocumentedContractDate==''){
            $('#DocumentedContractDate').css({'border-color':'red'});
        }
        else{
            $('#DocumentedContractDate').css({'border-color':'#ced4da'});
        }
        if(DocumentedContractNumber==''){
            $('#DocumentedContractNumber').css({'border-color':'red'});
        } 
        else{
            $('#DocumentedContractNumber').css({'border-color':'#ced4da'});
        }
        
        csui.require(['csui/dialogs/modal.alert/modal.alert'], function (ModalAlert) {
            ModalAlert.showError("Highlited Fields are Mandatory").always(function () { 
            });
        });    
    }
    }
    
    
    function createInternalContract(CustomerFileID,FinanceAgreementID){
    var InternalContractDate = $('#InternalContractDate').val();
    var InternalContractAmount = $('#InternalContractAmount').val();

    var typeOfContract2 = $('#TypeOfContract').val();

    let valDocumentedContract;
    if(typeOfContract2 == "تعديل"){
        valDocumentedContract = selectizeInternalDocContract.getValue();
    } else {
        valDocumentedContract = "";
    }


    if(InternalContractDate!='' & InternalContractAmount!='' & typeOfContract2 !=''){
                        

        var form = new FormData();
        
        var data = {
            "template_id":[LL_REPTAG_$InternalContract_DocTemp /] ,
            "parent_id": [LL_REPTAG_$InternalContract_ParentID /], // folder where the cws will be created
            "roles": { 
                "categories": {
                    "[LL_REPTAG_$CatInternalContract /]": {
                        "[LL_REPTAG_$CatInternalContract /]_3":InternalContractAmount,
                        "[LL_REPTAG_$CatInternalContract /]_2":InternalContractDate,
                        "[LL_REPTAG_$CatInternalContract /]_4":typeOfContract2,
                    }
                }
            }
        };	
        

        
        $('#LoadingImagePO').show();                
        form.append("body", JSON.stringify(data));
            $.ajax({
            url:"[LL_REPTAG_URLPREFIXFULL /]/api/v2/businessworkspaces",
            type: "POST",
            processData: false,
            mimeType: "multipart/form-data",
            contentType: false,
            data: form ,               
            beforeSend: function(xhr){
                xhr.setRequestHeader('OTCSTicket', '[LL_REPTAG_OTCSTICKET /]');
            },
            success:function(data){
                var res=JSON.parse(data);
                
                $('#LoadingImagePO').hide();
              
                    
               


                    var settingsAjax = {
                        "url": `[LL_REPTAG_URLPREFIXFULL /]/api/v2/businessworkspaces/${FinanceAgreementID}/relateditems`,
                        "method": "POST",
                        "timeout": 0,
                        "headers": {
                            "OTCSTicket": "[LL_REPTAG_OTCSTICKET /]",
                            "Content-Type": "application/x-www-form-urlencoded"
                        },
                        "data": {
                            "rel_bw_id": res.results.id,
                            "rel_type": "child"
                        }
                    };
    
                    $.ajax(settingsAjax).done(function (response) {


                            if(valDocumentedContract != ""){
                                var settingsAjaxDocumented = {
                                    "url": `[LL_REPTAG_URLPREFIXFULL /]/api/v2/businessworkspaces/${valDocumentedContract}/relateditems`,
                                    "method": "POST",
                                    "timeout": 0,
                                    "headers": {
                                        "OTCSTicket": "[LL_REPTAG_OTCSTICKET /]",
                                        "Content-Type": "application/x-www-form-urlencoded"
                                    },
                                    "data": {
                                        "rel_bw_id": res.results.id,
                                        "rel_type": "child"
                                    }
                                };

                                $.ajax(settingsAjaxDocumented).done(function (response) {
                                    csui.require(['csui/dialogs/modal.alert/modal.alert'], function (ModalAlert) {
                                    ModalAlert.showSuccess("Internal Contract Created").always(function () { 
                                        $("form")[0].reset();
                                    window.location.replace("[LL_REPTAG_URLPREFIX /]/app/nodes/"+res.results.id);
                                    });
                                    }); 

                                });


                            } else {
                        
                        
                                csui.require(['csui/dialogs/modal.alert/modal.alert'], function (ModalAlert) {
                                ModalAlert.showSuccess("Internal Contract Created").always(function () { 
                                    $("form")[0].reset();
                                window.location.replace("[LL_REPTAG_URLPREFIX /]/app/nodes/"+res.results.id);
                                });
                                }); 
                             }
                        
                    });
                   
                    
                



            },
            error: function(xhr, status, error) {
                $('#LoadingImagePO').hide();
                var err = JSON.parse(xhr.responseText);
                //alert(err.error);
                csui.require(['csui/dialogs/modal.alert/modal.alert'], function (ModalAlert) {
                    ModalAlert.showError("Internal Contract Creation Error. "+err.error).always(function () { 
                    });

                });                      
            }
        });                      
    }

    else{
        if(typeOfContract2==''){
            $('#TypeOfContract').css({'border-color':'red'});
        }
        else{
            $('#TypeOfContract').css({'border-color':'#ced4da'});
        }
        if(InternalContractDate==''){
            $('#InternalContractDate').css({'border-color':'red'});
        }
        else{
            $('#InternalContractDate').css({'border-color':'#ced4da'});
        }
        if(InternalContractAmount==''){
            $('#InternalContractAmount').css({'border-color':'red'});
        } 
        else{
            $('#InternalContractAmount').css({'border-color':'#ced4da'});
        }
        
        csui.require(['csui/dialogs/modal.alert/modal.alert'], function (ModalAlert) {
            ModalAlert.showError("Highlited Fields are Mandatory").always(function () { 
            });
        });    
    }
    }
    


    }
        
    );


</script>


